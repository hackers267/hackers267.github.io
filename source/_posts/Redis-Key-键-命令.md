---
title: Redis Key(键)命令
date: 2020-02-23 12:21:20
tags:
  - Redis
  - key
  - 键
categories:
- 数据库
- Redis
---
# Redis 键(key)命令

## 基础命令

对于Redis的*key*命令，我们来了解一下常用的几个命令，我们平时使用频率比较高的几个命令。

### Del

这个命令其实很简单啦，就是删除指定的*key*。其命令也很简单，为：`Del key1 ... keyN`。返回值为删除的*key*的数量。

### Exists

这个命令和*Del*命令一样简单，就是检查指定的*key*是否存在。其命令同样简单，为：`Exsits key1 ... keyN`。返回值为存在的*key*的数量。这里分情况解释一下：

+ 当只查询一个*key*是否存在的时候，
  + **1**->**存在**
  + **0**->**不存在**
+ 当查询多个*key*的时候
  + **0**->**都不存在**
  + 查询数量**等于**返回值大小，所有查询值都存在
  + 查询数量**小于**返回值大小，有部分的*key*不存在，但Redis没有告诉我们哪个不存在

### Expire

这个命令相对来说就复杂了一些，但也算简单的。它的作用就是给指定的*key*设置过期时间，单位为**秒**。其命令形式为：`Expire key timeout`。*key*只在指定的时间内有效，过了有效时间，*key*将不可用。当设置成功的时候，会返回1，而当*key*不存在或者不能给*key*设置过期时间的时候，将返回0。有人说了，这个命令给*key*设置的过期时间为*秒*，那我们有没有办法设置过期时间或者我们能不能设置某个值在某个具体的时间失效，而不用自己去计算呢？其实，Redis已经为我们准备了相应的命令：*PExpire*,*ExpireAt*和*PExpireAT*。

### PExpire

这个命令和*Expire*是一样的，只是指定的时间的单位由*秒*->*毫秒*。

### ExpireAt

这个命令的作用和*Expire*也是一直的，也是设置过期时间，但设置的不再是时间长度，而是指定具体到何时过期。值是一个具体的时间点，为时间戳。命令为：`ExpireAt key timestamp`。

### PExpireAt

和*ExpireAt*作用一致，区别在于时间戳的单位*不再是秒*,而是**毫秒时间戳**。

既然我们已经为*key*设置了过期时间，我们总得用办法知道，这个*key*还可以生存多长时间吧，在这个时候，我们就需要使用*TTL*和*PTTL*命令了。没错，这两个命令的区别在于，*TTL*的单位为**秒**，*PTTL*的单位为**毫秒**，你一定猜到了，对吧？:laughing:

### TTL

是单词*Time To Live*的缩写，记住这个单词，这个命令和这个命令的作用相信你已经记住个80%~90%。其命令为：`TTL key`。返回值：

+ -2 key不存在
+ -1 key没有设置过期时间
+ 其他值：剩余的生存时间

### PTTL

和*TTL*一样，只是剩余时间的单位为**毫秒**。

我们现在已经知道如何给某个*key*设置过期时间，以及查询其剩余的生存时间，那当我们想将这个*key*设置为永久生效，即取消过期时间的时候，我们应该怎么办呢？这个时候，我闷就用到了*Persist*命令了。

### Persist

这个命令的形式为：`Persist key`。就是这么简单，这样我们就可以取消该*key*的过期时间了。当过期时间取消成功的时候，返回值为**1**。而当*key*不存在或者*key*美誉设置过期时间的时候，返回**0**。

### Type

查询*key*存储值的类型，返回值为以下之一：

+ string 字符串
+ list 列表
+ set 集合
+ zset 有序集合
+ hash 哈希表
+ none *key*不存在

### Rename

修改*key*的名称。很简单吧，其语法也简单：`Rename old_key new_key`。请注意，在这两种情况下，会返回错误：

+ old_key 不存在
+ old_key 和 new_key 相同

**注意**,当*new_key*已经存在的时候，旧值会被覆盖！！！

### RenameNx

和*Rename*一样，也是给*key*改名，但只有当*new_key*不存在的时候才会执行。并且成功后返回**1**，*new_key*已经存在时，返回**0**。这个命令可以避免当*new_key*已经存在的时候，不小心覆盖旧值的问题。

### Keys

按照给定**正则表达式**查找符合此模式的*key*。其命令为：`keys pattern`返回值为查询到的值组成的*列表*。当需要查找所有值的时候，可使用`keys *`。

### RandomKey

顾名思义，这个命令就是从当前数据库中随机返回一个*key*.那么，当数据库中没有*key*时，会返回什么呢？答案是：**nil**。

### Move

这个命令将指定的*key*迁移到指定的数据库中。命令为：`Move key destiantion`。当迁移成功的时候，返回**1**，失败，返回**0**。

注意，如果当前*key*已经存在于目标数据库，则会迁移失败。

### Dump

序列化给定的*key*，被返回被序列化的值。

## Key 命令总结

梳理一下Redis中的*key*相关的命令：

+ 过期时间有关系的有：`Expire`,`Pexpire`,`ExpireAt`,`PExipreAt`,`TTL`,`PTTL`和`Persist`。
+ 重命名的：`Rename`和`RenameNx`
+ 是否存在的：`Exists`
+ 随机返回的：`RandomKey`
+ 查询列举的：`Keys`,`Type`
+ 移动删除的：`Move`,`Del`
+ 序列化的：`Dump`

最终梳理完了*key*相关的这几个命令，发现其实这几个命令也不是很难理解。更深入的时候和体验，需要我们慢慢在使用中体会和挖掘。

希望可以得到大家的关注和支持！！！
